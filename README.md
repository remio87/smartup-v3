Work in progress. Many functions should not be working. However, it works for my usage at least...
